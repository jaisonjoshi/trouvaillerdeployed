"use strict";(self.webpackChunktravel_app=self.webpackChunktravel_app||[]).push([[517],{5840:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var a=n(4165),r=n(5861),s=n(4942),o=n(1413),i=n(9439),c=n(2791),l=(n(3037),n(8688),n(5717),n(9751)),u=n(4642),d=n(8914),p=n(7689),h=n(2388),x=n(1640),m=(n(1061),n(5086),n(3433)),f=n(7893),g=n(4155),v=n(5450),Z=n(7248),j=n(6015),w=n(4565),b=n(6435),y=n(7205),C=n(7005),k=function(e){return new Promise((function(t,n){var a=new Image;a.addEventListener("load",(function(){return t(a)})),a.addEventListener("error",(function(e){return n(e)})),a.setAttribute("crossOrigin","anonymous"),a.src=e}))};function L(e){return e*Math.PI/180}function N(e,t,n){var a=L(n);return{width:Math.abs(Math.cos(a)*e)+Math.abs(Math.sin(a)*t),height:Math.abs(Math.sin(a)*e)+Math.abs(Math.cos(a)*t)}}function R(e,t){return U.apply(this,arguments)}function U(){return U=(0,r.Z)((0,a.Z)().mark((function e(t,n){var r,s,o,i,c,l,u,d,p,h,x=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x.length>2&&void 0!==x[2]?x[2]:0,s=x.length>3&&void 0!==x[3]?x[3]:{horizontal:!1,vertical:!1},e.next=4,k(t);case 4:if(o=e.sent,i=document.createElement("canvas"),c=i.getContext("2d")){e.next=9;break}return e.abrupt("return",null);case 9:return l=L(r),u=N(o.width,o.height,r),d=u.width,p=u.height,i.width=d,i.height=p,c.translate(d/2,p/2),c.rotate(l),c.scale(s.horizontal?-1:1,s.vertical?-1:1),c.translate(-o.width/2,-o.height/2),c.drawImage(o,0,0),h=c.getImageData(n.x,n.y,n.width,n.height),i.width=n.width,i.height=n.height,c.putImageData(h,0,0),e.abrupt("return",new Promise((function(e,t){i.toBlob((function(t){t.name="cropped.jpeg",e({file:t,url:URL.createObjectURL(t)})}),"image/jpeg")})));case 23:case"end":return e.stop()}}),e)}))),U.apply(this,arguments)}var I=n(184),S=function(e){var t=e.photoURL,n=e.setOpenCrop,s=e.setPhotoURL,o=e.setFile,l=e.imgFiles,u=e.setImgFiles,d=e.size,p=(0,c.useState)({x:0,y:0}),h=(0,i.Z)(p,2),x=h[0],k=h[1],L=(0,c.useState)(1),N=(0,i.Z)(L,2),U=N[0],S=N[1],M=(0,c.useState)(0),O=(0,i.Z)(M,2),P=O[0],D=O[1],_=(0,c.useState)(null),z=(0,i.Z)(_,2),E=z[0],V=z[1],A=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var r,i,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R(t,E,P);case 3:r=e.sent,i=r.file,c=r.url,s(c),o(i),u([].concat((0,m.Z)(l),[i])),n(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(v.Z,{dividers:!0,sx:{background:"#333",position:"relative",height:400,width:"auto",minWidth:{sm:500}},children:(0,I.jsx)(C.ZP,{image:t,crop:x,zoom:U,rotation:P,aspect:d,onZoomChange:S,onRotationChange:D,onCropChange:k,onCropComplete:function(e,t){V(t)}})}),(0,I.jsxs)(Z.Z,{sx:{flexDirection:"column",mx:3,my:2},children:[(0,I.jsxs)(j.Z,{sx:{width:"100%",mb:1},children:[(0,I.jsxs)(j.Z,{children:[(0,I.jsxs)(w.Z,{children:["Zoom: ",F(U)]}),(0,I.jsx)(b.ZP,{valueLabelDisplay:"auto",valueLabelFormat:F,min:1,max:3,step:.1,value:U,onChange:function(e,t){return S(t)}})]}),(0,I.jsxs)(j.Z,{children:[(0,I.jsxs)(w.Z,{children:["Rotation: ",P+"\xb0"]}),(0,I.jsx)(b.ZP,{valueLabelDisplay:"auto",min:0,max:360,value:P,onChange:function(e,t){return D(t)}})]})]}),(0,I.jsxs)(j.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,I.jsx)(y.Z,{variant:"outlined",startIcon:(0,I.jsx)(f.Z,{}),onClick:function(){return n(!1)},children:"Cancel"}),(0,I.jsx)(y.Z,{variant:"contained",startIcon:(0,I.jsx)(g.Z,{}),onClick:A,children:"Crop"})]})]})]})},F=function(e){return"".concat(Math.round(100*e),"%")},M=function(e){var t=e.setOpen,n=JSON.parse(window.sessionStorage.getItem("user")),m=h.Z.create({baseURL:"http://localhost:8080/api/"}),f=(0,p.s0)(),g=(0,d.Z)("/user/find/".concat(n._id)),v=g.data;g.loading,g.error;console.log(v);var Z=(0,c.useState)({}),j=(0,i.Z)(Z,2),w=j[0],b=j[1],y=function(e){b((function(t){return(0,o.Z)((0,o.Z)({},t),{},(0,s.Z)({},e.target.id,e.target.value))})),console.log(w)},C=(0,c.useState)(""),k=(0,i.Z)(C,2),L=k[0],N=k[1],R=(0,c.useState)(""),U=(0,i.Z)(R,2),F=U[0],M=U[1],O=(0,c.useState)(!1),P=(0,i.Z)(O,2),D=P[0],_=P[1],z=(0,c.useState)([]),E=(0,i.Z)(z,2),V=E[0],A=E[1],W=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(r){var s,i,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),t(!0),e.prev=2,s=v.img,""==L){e.next=12;break}return(i=new FormData).append("file",L),i.append("upload_preset","upload"),e.next=10,m.post("https://api.cloudinary.com/v1_1/difxlqrlc/image/upload",i);case 10:c=e.sent,s=c.data.url;case 12:return sessionStorage.setItem("user.img",s),l=(0,o.Z)((0,o.Z)({},w),{},{img:s}),console.log(l,"HAI"),e.next=17,m.patch("/user/".concat(n._id),l);case 17:console.log("new review has been created"),f("/user"),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),console.log(e.t0);case 24:t(!1);case 25:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(t){return e.apply(this,arguments)}}();return(0,I.jsxs)("div",{children:[(0,I.jsx)(u.Z,{}),D&&(0,I.jsx)("div",{className:"crop-box-con",children:(0,I.jsx)(S,{photoURL:F,setOpenCrop:_,setPhotoURL:M,setFile:N,imgFiles:V,setImgFiles:A,size:1})}),(0,I.jsx)("div",{className:"mt-20 md:mt-32 flex items-center justify-center px-8 py-8",children:(0,I.jsxs)("div",{className:"flex flex-col justify-center items-start  gap-[30px] user-con",children:[(0,I.jsx)("div",{className:"w-[50%] flex justify-start ",children:(0,I.jsx)("img",{className:"w-[60%] md:w-[70%] max-w-[500px] rounded-full",src:L?URL.createObjectURL(L):v.img,alt:""})}),(0,I.jsxs)("label",{htmlFor:"profilephoto",children:["Upload image  ",(0,I.jsx)(x.Z,{className:"upload-icn"})]}),(0,I.jsx)("input",{type:"file",id:"profilephoto",className:"hidden",onChange:function(e){var t=e.target.files[0];t&&(N(t),M(URL.createObjectURL(t)),_(!0),console.log(V))}}),(0,I.jsx)("div",{className:"w-[100%] md:w-[50%] flex flex-col gap-[10px] items-start",children:(0,I.jsxs)("form",{action:"",className:"flex flex-col gap-[10px] items-start text-[grey]",children:[(0,I.jsx)("input",{className:"border-none rounded outline-none",type:"text",defaultValue:v.username,id:"username",onChange:y}),v.google_id?(0,I.jsx)("div",{}):(0,I.jsx)("input",{type:"text",className:"border-none rounded outline-none",defaultValue:v.email,id:"email",onChange:y}),(0,I.jsx)("input",{type:"text",className:"border-none rounded outline-none",defaultValue:v.phone,id:"phone",onChange:y}),(0,I.jsx)("button",{className:"flex justify-center items-center bg-evergreen text-blacky-medium w-36 font-bold rounded-md p-2 my-5 hover:bg-whiteglow duration-500",onClick:W,children:"Update"})]})})]})}),(0,I.jsx)(l.Z,{})]})}},5086:function(){},1061:function(e,t,n){e.exports=n.p+"static/media/avatar.9e66268f4f32f01b9a52.png"}}]);
//# sourceMappingURL=517.e187ac76.chunk.js.map